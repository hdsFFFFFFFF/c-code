### C运算符

C提供了以下类型的运算符：

- 算术运算符
- 关系运算符
- 逻辑运算符
- 位运算符
- 赋值运算符
- 其它运算符

#### 算术运算符

下表显示了 C 语言支持的所有算术运算符。假设变量 **A** 的值为 10，变量 **B** 的值为 20

| 运算符 | 描述                             | 实例             |
| :----- | :------------------------------- | :--------------- |
| +      | 把两个操作数相加                 | A + B 将得到 30  |
| -      | 从第一个操作数中减去第二个操作数 | A - B 将得到 -10 |
| *      | 把两个操作数相乘                 | A * B 将得到 200 |
| /      | 分子除以分母                     | B / A 将得到 2   |
| %      | 取模运算符，整除后的余数         | B % A 将得到 0   |
| ++     | 自增运算符，整数值增加 1         | A++ 将得到 11    |
| --     | 自减运算符，整数值减少 1         | A-- 将得到 9     |

++ 在变量前面和后面是有区别的：

- ++ 在前面叫做`前自增`（例如 `++a`）。前自增先进行自增运算，再进行其他操作。
- ++ 在后面叫做`后自增`（例如 `a++`）。后自增先进行其他操作，再进行自增运算。



#### 关系运算符

下表显示了 C 语言支持的所有关系运算符。假设变量 **A** 的值为 10，变量 **B** 的值为 20，则：

| 运算符 | 描述                                                         | 实例            |
| :----- | :----------------------------------------------------------- | :-------------- |
| ==     | 检查两个操作数的值是否相等，如果相等则条件为真。             | (A == B) 为假。 |
| !=     | 检查两个操作数的值是否相等，如果不相等则条件为真。           | (A != B) 为真。 |
| >      | 检查左操作数的值是否大于右操作数的值，如果是则条件为真。     | (A > B) 为假。  |
| <      | 检查左操作数的值是否小于右操作数的值，如果是则条件为真。     | (A < B) 为真。  |
| >=     | 检查左操作数的值是否大于或等于右操作数的值，如果是则条件为真。 | (A >= B) 为假。 |
| <=     | 检查左操作数的值是否小于或等于右操作数的值，如果是则条件为真。 | (A <= B) 为真。 |



#### 逻辑运算符

下表显示了 C 语言支持的所有关系逻辑运算符。假设变量 **A** 的值为 1，变量 **B** 的值为 0，则：

| 运算符 | 描述                                                         | 实例              |
| :----- | :----------------------------------------------------------- | :---------------- |
| &&     | 称为逻辑与运算符。如果两个操作数都非零，则条件为真。         | (A && B) 为假。   |
| \|\|   | 称为逻辑或运算符。如果两个操作数中有任意一个非零，则条件为真。 | (A \|\| B) 为真。 |
| !      | 称为逻辑非运算符。用来逆转操作数的逻辑状态。如果条件为真则逻辑非运算符将使其为假。 | !(A && B) 为真。  |



#### 位运算符

位运算符作用于位，并逐位执行操作。&、 | 和 ^ 的真值表如下所示：

| p    | q    | p & q | p \| q | p ^ q |
| :--- | :--- | :---- | :----- | :---- |
| 0    | 0    | 0     | 0      | 0     |
| 0    | 1    | 0     | 1      | 1     |
| 1    | 1    | 1     | 1      | 0     |
| 1    | 0    | 0     | 1      | 1     |

假设如果 A = 60，且 B = 13，现在以二进制格式表示，它们如下所示：

A = 0011 1100

B = 0000 1101

```c
A&B = 0000 1100

A|B = 0011 1101

A^B = 0011 0001

  ~A = 1100 0011
```

下表显示了 C 语言支持的位运算符。假设变量 **A** 的值为 60，变量 **B** 的值为 13，则：

| 运算符 | 描述                                                         | 实例                                                         |
| :----- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| &      | 按位与操作，按二进制位进行"与"运算。运算规则：`0&0=0;    0&1=0;     1&0=0;      1&1=1;` | (A & B) 将得到 12，即为 0000 1100                            |
| \|     | 按位或运算符，按二进制位进行"或"运算。运算规则：`0|0=0;    0|1=1;    1|0=1;     1|1=1;` | (A \| B) 将得到 61，即为 0011 1101                           |
| ^      | 异或运算符，按二进制位进行"异或"运算。运算规则：`0^0=0;    0^1=1;    1^0=1;   1^1=0;` | (A ^ B) 将得到 49，即为 0011 0001                            |
| ~      | 取反运算符，按二进制位进行"取反"运算。运算规则：`~1=0;    ~0=1;` | (~A ) 将得到 -61，即为 1100 0011，一个有符号二进制数的补码形式。 |
| <<     | 二进制左移运算符。将一个运算对象的各二进制位全部左移若干位（左边的二进制位丢弃，右边补0）。 | A << 2 将得到 240，即为 1111 0000                            |
| >>     | 二进制右移运算符。将一个数的各二进制位全部右移若干位，正数左补0，负数左补1，右边丢弃。 | A >> 2 将得到 15，即为 0000 1111                             |



#### 赋值运算符

下表列出了C语言支持的赋值运算符：

| 运算符 | 描述                                                         | 实例                            |
| ------ | ------------------------------------------------------------ | ------------------------------- |
| =      | 简单的赋值运算符，把右边操作数的值赋给左边操作数             | C = A + B 将把 A + B 的值赋给 C |
| +=     | 加且赋值运算符，把右边操作数加上左边操作数的结果赋值给左边操作数 | C += A相当于C = C + A           |
| -=     | 减且赋值运算符，把左边操作数减去右边操作数的结果赋值给左边操作数 | C -= A 相当于 C = C - A         |
| *=     | 乘且赋值运算符，把右边操作数乘以左边操作数的结果赋值给左边操作数 | C *= A 相当于 C = C * A         |
| /=     | 除且赋值运算符，把左边操作数除以右边操作数的结果赋值给左边操作数 | C /= A 相当于 C = C / A         |
| %=     | 求模且赋值运算符，求两个操作数的模赋值给左边操作数           | C %= A相当于C = C % A           |
| <<=    | 左移且赋值运算符                                             | C <<= 2等同于C = C << 2         |
| >>=    | 右移且赋值运算符                                             | C >>= 2 等同于 C = C >> 2       |
| &=     | 按位与且赋值运算符                                           | C &= 2 等同于 C = C & 2         |
| ^=     | 按位异或且赋值运算符                                         | C ^= 2 等同于 C = C ^ 2         |
| \|=    | 按位或且赋值运算符                                           | C \|= 2 等同于 C = C \| 2       |



#### 其它运算符和三元运算符

下表列出了 C 语言支持的其他一些重要的运算符，包括 `sizeof` 和 **? :**。

| 运算符     | 描述             | 实例                                  |
| :--------- | :--------------- | :------------------------------------ |
| `sizeof()` | 返回变量的大小。 | `sizeof(a)` 将返回 4，其中 a 是整数。 |
| &          | 返回变量的地址。 | &a将给出变量的线性地址(虚拟地址)。    |
| *          | 指向一个变量。   | *a表示a是一个指针变量                 |
| ? :        | 条件表达式       | 如果条件为真 ? 则值为X : 否则值为Y    |



#### C中的运算符优先级与结合性

| 优先级 | 运算符                                        | 结合性     |
| ------ | --------------------------------------------- | ---------- |
| 1      | []，()，**.**，->                             |            |
| 2      | -, (type), ++, --, *(取值), &, !, ~, `sizeof` | 左 <--- 右 |
| 3      | /, *, %                                       |            |
| 4      | +, -                                          |            |
| 5      | <<, >>                                        |            |
| 6      | >, >=, <, <=                                  |            |
| 7      | ==, !=                                        |            |
| 8      | &(按位与)                                     |            |
| 9      | ^                                             |            |
| 10     | \|                                            |            |
| 11     | &&                                            |            |
| 12     | \|\|                                          |            |
| 13     | ? : (条件表达式)                              | 左 <--- 右 |
| 14     | =, /=, *=, %=, +=, -=, <<=, >>=, &=, ^=, \|=  | 左 <--- 右 |
| 15     | , (逗号表达式)                                |            |

> 单目运算符 具有相同的优先级

**说明:**

- 运算符共分为15级，1级优先级最高，15级优先级最低。
- 同一优先级的运算符，运算次序由结合方向所决定。(结合性：2 13 14 是从右至左 其他都是 从左至右)
- 简单记就是：！ > 算术运算符 > 关系运算符 > && > || > 赋值运算符



基本的优先级需要记住：

- 指针最优，单目运算优于双目运算。如正负号。

- 先算术运算，后移位运算，最后位运算。

  请特别注意：`1 << 3 + 2 & 7等价于 (1 << (3 + 2))&7.`

- 逻辑运算最后结合。



**记忆口诀**

括号成员第一;        		//括号运算符[]() 成员运算符. ->

全体单目第二;       		//所有的单目运算符比如++、 --、 +(正)、 -(负) 、指针运算\*、&

乘除余三,加减四;    							//这个"余"是指取余运算即%

移位五，关系六;    							 //移位运算符：<< >> ，关系：> < >= <= 等

等于(与)不等排第七;   						//即== 和!=

位与异或和位或, 三分天下"八九十;   //这几个都是位运算: 位与(&)异或(^)位或(|)

逻辑或跟与;       								 //逻辑运算符:|| 和 &&

十二和十一;     									//注意顺序:优先级(||) 底于 优先级(&&)

条件高于赋值;       	 //三目运算符优先级排到13 位只比赋值运算符和","高

逗号运算级最低!    	 //逗号运算符优先级最低



C 语言与其他高级语言相比, 一个显著的特点就是其运算符特别丰富, 共有34 种运算符。C 语言将这34 种运算符规定了不同的优先级别和结合性。优先级是用来标识运算符在表达式中的运算顺序的, 在求解表达式的值的时候, 总是先按运算符的优先次序由高到低进行操作, 可是, 当一个运算对象两侧的运算符优先级别相同时, 则按运算符的结合性来确定表达式的运算顺序。 

运算符的结合性指同一优先级的运算符在表达式中操作的组织方向, 即: 当一个运算对象两侧运算符的优先级别相同时, 运算对象与运算符的结合顺序,C 语言规定了各种运算符的结合方向( 结合性) 。

大多数运算符结合方向是“自左至右”, 即: 先左后右, 例如a- b+c, b 两侧有- 和+两种运算符的优先级相同, **按先左后右结合方向, b 先与减号结合, 执行a- b 的运算, 再执行加c 的运算**。

<u>着重强调一点，无论是左结合性，还是右结合性，是**针对**两个相邻的优先级相同的**运行符**而言(不是表达中的运算对象)，**运算符是决定左右的基准点**，先以前面的运算符(即位置上处于左边的运算符)构造运算，就是左结合，反之，就是右结合</u>

除了自左至右的结合性外, C 语言有**三类**运算符参与运算的结合方向是**从右至左**。即: **单目**运算符, **条件**运算符, 以及**赋值**运算符。

关于**结合性**的概念在其他高级语言中是没有的, 这是**C语言的特点之一**,特别是从右至左结合性容易出错, 下面通过几个具体的运算符来剖析C 语言运算符的结合性。 

若a 是一个变量, 则`++a` 或`a++`和`- - a` 或`a- -` 分别称为前置加或后置加运算和前置减或后置减运算, 且`++a` 或`a++`等价于a=a+1, `- - a` 或`a- -` 等价于a=a- 1, 即都是使该变量的值增加1 或减少1。由此可知, 对一个变量实行前置或后置运算, 其运算结构是相同的, 但当它们与其他运算结合在一个表达式中时, 其运算值就不同了。

前置运算是变量的值先加1 或减1, 然后将改变后的变量值参与其他运算, 如x=5; y=8; c=++x\*y; 运算后, c 的值是48,x 的值是6,y 的值是8。

而后置运算是变量的值先参与有关运算, 然后将变量本身的值加1 减1, 即参加运算的是该变量变化前的值。如x=5; y=8; c=x++\*y;运算后, c 的值是40,x 的值是6, y 的值是8。

值得注意的是, **前置、后置运算只能用于变量, 不能用于常量和表达式**, 且结合方向是从右至左。如当i=6 时, 求- i++的值和i 的值。由于“- ”(负号) “++”为同一个优先级, 故应理解为- (i++), 又因是后置加, 所以先有- i++的值为- 6, 然后i 增值1 为7, 即i=7。

#### 一些容易出错的优先级问题

上表中，优先级同为1 的几种运算符如果同时出现，那怎么确定表达式的优先级呢？。下表就整理了这些容易出错的情况：

| 优先级问题                                    | 表达式                 | 经常误认为的结果                                            | 实际结果                                                     |
| --------------------------------------------- | ---------------------- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| . 的优先级高于 *（-> 操作符用于消除这个问题） | `*p.f`                 | p 所指对象的字段 f，等价于： (*p).f                         | 对 p 取 f 偏移，作为指针，然后进行解除引用操作，等价于： `*(p.f)` |
| [] 高于 *                                     | `int *ap[]`            | `ap` 是个指向 int 数组的指针，等价于： `int (*ap)[]`        | `ap` 是个元素为 int 指针的数组，等价于： `int *(ap [])`      |
| 函数 () 高于 *                                | `int *fp()`            | `fp` 是个函数指针，所指函数返回 int，等价于： `int (*fp)()` | `fp` 是个函数，返回 int*，等价于： `int *  ( fp() )`         |
| == 和 != 高于位操作                           | (val & mask != 0)      | (val &mask) != 0                                            | val & (mask != 0)                                            |
| == 和 != 高于赋值符                           | `c = getchar() != EOF` | `(c = getchar()) != EOF`                                    | `c = (getchar() != EOF)`                                     |
| 算术运算符高于位移 运算符                     | `msb << 4 + lsb`       | `(msb << 4) + lsb`                                          | `msb << (4 + lsb)`                                           |
| 逗号运算符在所有运 算符中优先级最低           | i = 1, 2               | i = (1,2)                                                   | (i = 1), 2                                                   |



#### 参考资料

- [C语言运算符的优先级和结合性一览表](http://c.biancheng.net/cpp/html/462.html)
- [c语言运算符优先级结合性(左/右结合详解)](https://blog.csdn.net/hitwhylz/article/details/14526569#:~:text=%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84%E7%BB%93%E5%90%88%E6%80%A7%E6%8C%87%E5%90%8C%E4%B8%80%E4%BC%98%E5%85%88%E7%BA%A7%E7%9A%84,%E7%BB%93%E5%90%88%E6%96%B9%E5%90%91(%20%E7%BB%93%E5%90%88%E6%80%A7)%20%E3%80%82)
- [C语言中文网:C语言运算符优先级和结合性](http://c.biancheng.net/view/161.html)

